<!DOCTYPE html>
<html>
  <head>
    <title>Login</title>
    <script src="https://descopecdn.com/npm/@descope/web-component@3.21.0/dist/index.js"></script>
    <script src="https://descopecdn.com/npm/@descope/web-js-sdk@1.16.0/dist/index.umd.js"></script>
    <style>
      html, body { height: 100%; margin:0; }
      body {
        display: flex;
        height: 100vh;
        justify-content: center;
        align-items: center;
        background: radial-gradient(1200px 800px at 10% 10%, #e8f1ff, #f6f9ff 60%);
        font-family: 'Inter', Arial, sans-serif;
        color: #0f172a;
      }
      .login-container {
        width: 420px;
        text-align: center;
        padding: 32px 28px;
        background: rgba(255,255,255,0.95);
        border-radius: 16px;
        box-shadow: 0 12px 40px rgba(21,101,192,0.15);
        border: 1px solid #e3f0ff;
      }
      .title { font-weight: 800; font-size: 1.6rem; margin-bottom: 8px; }
      .subtitle { color: #5b6b86; margin-bottom: 22px; }
    </style>
  </head>
  <body>
    <div class="login-container">
      <div class="title">üîê Trinity Chat</div>
      <div class="subtitle">Sign in to continue</div>
      <descope-wc
        project-id="P32EWDJvVgaIyVQcl851PmS7N7L7"
        flow-id="inbound-apps-user-consent"
        theme="light"
        id="descope-login"
      ></descope-wc>
    </div>

    <script>
      window.DescopeConfig = {
        projectId: "P32EWDJvVgaIyVQcl851PmS7N7L7",
        redirectUrl: "/chat"
      };
      const widget = document.getElementById("descope-login");
      widget.addEventListener("success", async (e) => {
      const resp = await fetch("/callback", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ sessionJwt: e.detail.sessionJwt })
      });
      const data = await resp.json();
      if (data.success) window.location.href = "/chat";
      else alert("Login failed");
      });
    </script>
  </body>
</html>
